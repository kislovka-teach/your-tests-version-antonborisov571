## Особенности работы:
- Правильно описана модель БД - до 2 баллов
- Правильно сформированы миграции и настроены ограничения - до 3 баллов
- Правильно реализована авторизация и аутентификация - до 2 баллов
- Выполнены все методы API со всей логикой - до 5 баллов
- Сделаны репозитории под нужные модели - до 3 баллов

**Итого 15 баллов.**

## Подсказки:
- сначала создайте модели БД
- идентификаторы не указаны, необходимо понять связи исходя из контекста и добавлять их по мере необходимости
- создайте модели запросов и ответов если они отличны от моделей БД
- опишите DbContext и создайте миграции
- Создайте интерфейсы сервисов и репозиториев
- реализуйте аутентификацию и авторизацию
- реализуйте интерфейсы 
- опишите методы API  
- Для всех вариантов обязательное требование - использовать метод HasData в DbContext чтобы вручную создать несколько записей в БД которые будут отправной точкой для тестирования (и вам удобно и мне при проверке)
- Можно делать несколько последовательных миграций (например сначала сделать пользователя и миграцию с ним, реализовать авторизацию, а потом заняться остальными сущностями)

## Вариант 1. API сервиса для попутных поездок.

### Модели данных:

1. _Пользователи_
   - Имя
   - Фамилия
   - Логин
   - Пароль
   - Дата регистрации
   - Номер телефона
   - Стаж вождения в годах (по умолчанию 0)
2. _Координаты_
   - Широта
   - Долгота
3. _Города_
   - Название города
   - Координаты города
4. _Поездки_
   - Водитель
   - Время выезда
   - Время приезда
   - Город отбытия
   - Город прибытия
   - Стоимость поездки
   - Максимальное количество пассажиров
   - Пассажиры (m-t-m с пользователями)
   - Машина (просто название)
   - Музыка (boolean, по умолчанию false)
   - Курение (boolean, по умолчанию false)
   - Животные (boolean, по умолчанию false)
4. _Отзывы_
   - Поездка
   - Пользователь отправитель
   - Пользователь получатель
   - Текст отзыва
   - Оценка

### Методы API:

1. ```/login``` - аутентификация пользователя по логину и паролю. Производится через JWT токен.
2. ```/trips/add``` - добавление новой поездки (передаётся все необходимые данные поездки: название городов, время отбытия, время прибытия, максимальное количество пассажиров, стоимость, машина, музыка, курение, животные)
3. ```/trips/by_cities_trips``` - (в body передаётся названия городов, дата поездки) возращает все незавершенные и неначавшияся поездки, со свободными местами, с соответствующими городами и временем поездки. Информация о поездках: имя водителя, город отбытия, город прибытия, время начала поездки, конца.  
4. ```/trips/by_coordinates_trips``` - (в body передаётся координаты, дата поездки) возращает все незавершенные и неначавшияся поездки, со свободными местами, с соответствующими началом, концом пути и временем поездки. Информация о поездках: имя водителя, город отбытия, город прибытия, время начала поездки, конца.
5. ```/trips/{id}``` - id - идентификатор поездки, возращается информация о поездке, имя водителя, город отбытия, город прибытия, время начала поездки, конца, можно ли курить, брать животных, слушать свою музыку.
6. ```/trips/{id}/get_driver``` - id - идентификатор поездки, возращается информация о водителе, его оценка, сколько поездок, стаж вождения, дата регистрации и все отзывы о нём.
7. ```/trips/{id}/add_passenger``` - id - идентификатор поездки, забронировать поездку, если есть свободные места, то возращается сообщение об успехе и номер мобильного телефона водителя, в ином случае сообщение о том что все места заняты.
8. ```/trips/{id}/add_review``` - добавление отзыва о поездки, может пользователь, который был пассажиром и после завершения самой поездки. 

### Особенности реализации:
- При создании jwt токена параметры issuer, audience можно оставить как пустые строки и не проверять их
- При добавлении новой поездки, идентификатор пользователя берется из токена, перед сохранением в БД нужно убедится что у данного водителя не пересекается ли его время уже зарегистрированных поездок с новой поездкой
- Модели запроса и результата запроса могут отличаться от моделей БД
```/trips/by_coordinates_trips``` для данного endpoint-а нужно выбрать, те поездки, города которых находятся не более чем в 20 км от указанных координат. Расстояние можно посчитать по следующей формуле:  

   ```L = arccos(sin(φА)·sin(φB) + cos(φА)·cos(φB)·cos(λА − λB)) * R```, 

   где ```φА, φB``` - широты пунктов в градусах [-90; 90], 

   ```λА, λB``` - долготы пунктов в градусах [0; 180],

   ```R``` = 6371 км - радиус Земли

 
